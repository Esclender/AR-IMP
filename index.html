<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <title>Vite + React</title>
  </head>

  <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

  <script>
    const imgsIds = [
      {id: "nft", url: "https://mp-example-bucket.s3.sa-east-1.amazonaws.com/ar-folder/nft.mp4?response-content-disposition=inline&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXNhLWVhc3QtMSJGMEQCIFz%2BZdUr%2BoKD8WCymqfqGxzQKNga2T4NrC4ZORltT5osAiBO%2FZEnSuVRBN61AYo%2FEDBKcMkc4srg7v4MI9t1w2sWYyrtAgiX%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAEaDDQ5NDc0NjIzNTg5NCIMjdSmA25z7ksR30NPKsECH291qMSGbVxyrBcZOiM6xguboA5ZbHOZfdumDNUoYXy5Mi7crSknzKZNQjXvscnvMSHHEU7IKcsqODmotvkyj4fwNbev43msF%2FMOHumZpJIb82g6SpqIyXbcqb%2B9BqGToFEA8gmPVwZk1jJRtl%2FIq07lIAGSMhypAHnqV%2BYrRd7PVZzMNbaQS4QQkA5nR4ymfmPkQhBGxfy7gHMNO7bf5DI%2Fi1YE3wvRoHhU0cJM25qmbpnAp%2FksJR%2FAUNjTXV1RBDgO4AQvryghLBQIc4GaHigWaeTNXEl7UQvbzf6mYM4fw24QOHchtz8XfgVJOtb0K9Ta5gQ9fUj%2Fq%2Fe%2Bf13xFUfDvISwtYyK4DiESFyOCrcwnbqn5jklxAEyoe7aVbGl7pVCZko522gZdDmm9dg90vui7YZpjMfV9NNxfuv%2Bmc%2BsMImO068GOrQCyJXoFIol4oGA3Z3WFJeGBJ9TrzRSTj6Ae3MA%2FjfGc9xZVQHKGlZtEWnJk%2F4JRsHaCPZkjafyte0q8VctmKSOFBKnXx2gbDySJNsu9PYoaFIbdKGNeaRZH5xGbR2cBF1h4NRp0G50V92d6WnPquuVEO7ceDjmJPVWjDvXgNFuBn%2Fpxu3WtGHe90j%2FNM8L6%2BMNoQdjxwo1d2I3vlTT7UBkgy7%2FyYbNRAjn0HEzGiDKUFtinEVzn4d%2FvKHFqsRYLpt%2Blew0iLlLqaNDGVIhDfV%2FXnoC2LW2wA9JhhTB3%2BJXbC1R5te22rq97MkRf4K6UfRABrMa%2FSLDewzovFQOIHEWDD6H558jiU%2FbyusL39lYx9h7iVMBye%2BFdwIGStugETl8LkhsTPW4WzkjoxTlRpENuh%2BIAow%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20240315T223327Z&X-Amz-SignedHeaders=host&X-Amz-Expires=43200&X-Amz-Credential=ASIAXGMJMOP3LJ4TNCOK%2F20240315%2Fsa-east-1%2Fs3%2Faws4_request&X-Amz-Signature=7dad55a9b7fe7f639c9e7151c2a695569d4d7e1a3132edc72495866e7906e091"},
      // {id: "nft2", url: "/react.mp4"},
      // {id:"im1", url: "/react.mp4"},
      // {id:"im2", url: "/react.mp4"},
      // {id: "im3", url: "/react.mp4"},
      // {id: "im4", url: "/react.mp4"},
      // {id: "im5", url: "/react.mp4"},
      // {id: "im6", url: "/react.mp4"},
      // {id: "im7", url: "/react.mp4" },
      // {id: "im8", url: "/react.mp4"}
    ]

  

    function renderScene() {
      const root = document.querySelector('#root')
      const sceneElement = document.createElement("a-scene");
      const assets = document.createElement("a-assets");

      sceneElement.setAttribute("scene", "");
      sceneElement.setAttribute("vr-mode-ui", "enabled: false;");
      sceneElement.setAttribute("renderer", "antialias: true; alpha: true; precision: mediump;");
      sceneElement.setAttribute("embedded", "");
      sceneElement.setAttribute("arjs", "trackingMethod: best; sourceType: webcam; debugUIEnabled: false;");


      // Iterate through the array of image IDs and create video elements
      imgsIds.forEach(({id, url}) => {
          const videoElement = document.createElement("video");
          videoElement.setAttribute("src", `${url}`);
          videoElement.setAttribute("preload", "auto");
          videoElement.setAttribute("id", id);
          videoElement.setAttribute("loop", "");
          videoElement.setAttribute("crossorigin", "anonymus");

          // Append the video element to the assets
          assets.appendChild(videoElement);
      })
      
      sceneElement.appendChild(assets)

      imgsIds.forEach(({id, url}) => {
          const aVideo = document.createElement("a-video")
          const nftElement = document.createElement("a-nft");

          aVideo.setAttribute("src", `#${id}`);
          aVideo.setAttribute("rotation", {x:-90 , y: 0, z: 0});
          aVideo.setAttribute("position",{x:90 , y: 0, z: -240} );
          aVideo.setAttribute("width", "170");
          aVideo.setAttribute("height", "340");


          nftElement.setAttribute(`${id}`, "");
          nftElement.setAttribute("type", "nft");
          nftElement.setAttribute("url", `/data/${id}/${id}`);
          nftElement.setAttribute("smooth", "true");
          nftElement.setAttribute("smoothount", "10");
          nftElement.setAttribute("smoothtolerance", "0.01");
          nftElement.setAttribute("smooththreshold", "5");

          nftElement.appendChild(aVideo);
          sceneElement.appendChild(nftElement);
      })

      root.appendChild(sceneElement);
      
    }
  </script>
  
  <script>

    

    window.onload = function() {
      renderScene()


      AFRAME.registerComponent('scene', {
          init: function() {
            var scene = this.el;
    
            console.log(window.innerWidth, window.innerHeight, 'SIZES OF SCREEN')
          },
        });

      imgsIds.map(({id}) => {
         return AFRAME.registerComponent(id, {
          init: function() {
            var marker = this.el;
            this.vid = document.querySelector(`#${id}`)
    
            marker.addEventListener(
              "markerFound",
              function() {
                console.log(id, 'found')
                this.vid.play();
              }.bind(this)
            );
    
            marker.addEventListener(
              "markerLost",
              function() {
                this.vid.pause();
                this.vid.currentTime = 0;
              }.bind(this)
            );
          },
        });
      })
    };
  </script>
  
  <body id="root"  style="margin : 0px; overflow: hidden;">
    <div class="arjs-loader">
      <div>Loading, please wait...</div>
    </div>

    
</body>
</html>
